// =============================================================================
// CASH MOVEMENTS PAGE - Fluent Design System 2
// =============================================================================
// Estilos para la página de movimientos de caja
// Incluye: listado de movimientos, filtros, diálogos y tabla
// =============================================================================

@use '../abstracts' as *;

// -----------------------------------------------------------------------------
// LAYOUT
// -----------------------------------------------------------------------------

.cash-movements-page {
  display: flex;
  flex-direction: column;
  gap: $spacing-24;
  padding: $spacing-32;
  max-width: 1920px;

  @include tablet {
    gap: $spacing-20;
    padding: $spacing-20;
  }

  @include mobile {
    gap: $spacing-16;
    padding: $spacing-16;
  }

  // ---------------------------------------------------------------------------
  // HEADER - Mismo ancho que la card
  // ---------------------------------------------------------------------------

  &__header {
    display: flex;
    flex-direction: column;
    gap: $spacing-16;
    max-width: 1200px;

    @media (min-width: 768px) {
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
    }
  }

  &__header-content {
    display: flex;
    flex-direction: column;
    gap: $spacing-4;
  }

  &__title {
    font-size: $font-size-800;
    line-height: $line-height-400;
    font-weight: $font-weight-semibold;
    margin: 0;

    @include themify {
      color: themed('text-primary');
    }
  }

  &__description {
    font-size: $font-size-300;
    line-height: $line-height-300;
    margin: $spacing-4 0 0 0;

    @include themify {
      color: themed('text-secondary');
    }

    strong {
      font-weight: $font-weight-semibold;

      @include themify {
        color: themed('text-primary');
      }
    }
  }

  // ---------------------------------------------------------------------------
  // ACTION BUTTONS
  // ---------------------------------------------------------------------------

  &__actions {
    display: flex;
    gap: $spacing-12;
    flex-wrap: wrap;
  }

  &__btn-filter {
    font-size: $font-size-300;
    font-weight: $font-weight-medium;
    padding: $spacing-8 $spacing-16;
    border-radius: $border-radius-medium;
    display: flex;
    align-items: center;
    gap: $spacing-8;
    @include transition((background-color, border-color, color));

    @include themify {
      background-color: themed('bg-primary') !important;
      color: themed('text-primary') !important;
      border: 1px solid themed('border-default') !important;

      &:hover {
        background-color: themed('bg-secondary') !important;
        border-color: themed('border-strong') !important;
      }
    }

    &--active {
      @include themify {
        border-color: themed('action-primary') !important;
        color: themed('action-primary') !important;
      }
    }

    .filter-badge {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: $brand-100;
    }
  }

  &__btn-new {
    font-size: $font-size-300;
    font-weight: $font-weight-medium;
    padding: $spacing-8 $spacing-16;
    border-radius: $border-radius-medium;
    display: flex;
    align-items: center;
    gap: $spacing-8;
    @include transition((background-color, box-shadow));
    box-shadow: $shadow-4;

    @include themify {
      background-color: themed('action-primary') !important;
      color: themed('text-inverted') !important;
      border: none !important;

      &:hover {
        background-color: themed('action-primary-hover') !important;
      }
    }
  }

  // ---------------------------------------------------------------------------
  // FILTERS PANEL
  // ---------------------------------------------------------------------------

  &__filters {
    padding: $spacing-20;
    border-radius: $border-radius-large;
    max-width: 1200px;
    @include elevation(2);

    @include themify {
      background-color: themed('surface-card');
      border: 1px solid themed('border-subtle');
    }
  }

  &__filters-row {
    display: grid;
    grid-template-columns: 1fr;
    gap: $spacing-16;

    @media (min-width: 768px) {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  &__filters-actions {
    display: flex;
    justify-content: flex-end;
    gap: $spacing-12;
    margin-top: $spacing-16;
    padding-top: $spacing-16;

    @include themify {
      border-top: 1px solid themed('border-subtle');
    }
  }

  // ---------------------------------------------------------------------------
  // CARD / TABLE CONTAINER
  // ---------------------------------------------------------------------------

  &__card {
    padding: $spacing-24;
    border-radius: $border-radius-large;
    max-width: 1200px;
    @include elevation(2);

    @include themify {
      background-color: themed('surface-card');
      border: 1px solid themed('border-subtle');
    }

    @include mobile {
      padding: $spacing-16;
    }
  }

  &__table-wrapper {
    overflow-x: auto;
    margin: -$spacing-8;
    padding: $spacing-8;
  }

  &__empty {
    text-align: center;
    padding: $spacing-48 $spacing-24;

    @include themify {
      color: themed('text-tertiary');
    }
  }

  // ---------------------------------------------------------------------------
  // EMPTY STATE (No cash register)
  // ---------------------------------------------------------------------------

  &__empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: $spacing-64 $spacing-24;
    gap: $spacing-16;

    h2 {
      font-size: $font-size-600;
      font-weight: $font-weight-semibold;
      margin: 0;

      @include themify {
        color: themed('text-primary');
      }
    }

    p {
      font-size: $font-size-300;
      margin: 0;
      max-width: 400px;

      @include themify {
        color: themed('text-secondary');
      }
    }
  }

  &__empty-icon {
    width: 64px;
    height: 64px;

    @include themify {
      color: themed('text-tertiary');
    }
  }
}

// -----------------------------------------------------------------------------
// TABLE STYLES
// -----------------------------------------------------------------------------

.cash-movements-page {
  table {
    width: 100%;
    border-collapse: collapse;
  }

  th,
  td {
    padding: $spacing-12 $spacing-16;
    text-align: left;
    white-space: nowrap;

    &.text-right {
      text-align: right;
    }

    &.text-center {
      text-align: center;
    }
  }

  th {
    font-size: $font-size-200;
    font-weight: $font-weight-semibold;
    text-transform: uppercase;
    letter-spacing: 0.5px;

    @include themify {
      color: themed('text-tertiary');
      border-bottom: 1px solid themed('border-subtle');
    }
  }

  td {
    font-size: $font-size-300;

    @include themify {
      color: themed('text-primary');
      border-bottom: 1px solid themed('border-subtle');
    }
  }

  tr:hover td {
    @include themify {
      background-color: themed('bg-secondary');
    }
  }

  tr.row--reversal td {
    opacity: 0.6;
    font-style: italic;
  }

  .text-success {
    color: $success-100 !important;
  }

  .text-error {
    color: $error-100 !important;
  }
}

// -----------------------------------------------------------------------------
// MOVEMENT BADGES
// -----------------------------------------------------------------------------

.movement-badge {
  display: inline-flex;
  align-items: center;
  gap: $spacing-4;
  padding: $spacing-4 $spacing-8;
  border-radius: $border-radius-small;
  font-size: $font-size-200;
  font-weight: $font-weight-medium;

  &--income {
    background-color: rgba($success-100, 0.15) !important;
    color: $success-100 !important;
    border: none !important;
  }

  &--expense {
    background-color: rgba($error-100, 0.15) !important;
    color: $error-100 !important;
    border: none !important;
  }

  &--adjustment {
    background-color: rgba($warning-100, 0.15) !important;
    color: $warning-100 !important;
    border: none !important;
  }

  &--transfer {
    @include themify {
      background-color: themed('bg-tertiary') !important;
      color: themed('text-secondary') !important;
    }
    border: none !important;
  }
}

// -----------------------------------------------------------------------------
// MOVEMENT DETAILS
// -----------------------------------------------------------------------------

.movement-details {
  display: flex;
  flex-direction: column;
  gap: $spacing-2;

  &__sale {
    font-size: $font-size-200;
    font-weight: $font-weight-medium;
    color: $brand-100;
  }

  &__purchase {
    font-size: $font-size-200;
    font-weight: $font-weight-medium;
    color: #9333ea; // purple
  }

  &__client,
  &__supplier {
    font-size: $font-size-100;

    @include themify {
      color: themed('text-tertiary');
    }
  }
}

// -----------------------------------------------------------------------------
// VOID BUTTON
// -----------------------------------------------------------------------------

.btn-void {
  padding: $spacing-4 $spacing-8;
  border-radius: $border-radius-small;
  @include transition((background-color, color));

  @include themify {
    color: themed('text-tertiary');

    &:hover {
      color: $error-100;
      background-color: rgba($error-100, 0.1);
    }
  }
}

// -----------------------------------------------------------------------------
// FORM COMPONENTS
// -----------------------------------------------------------------------------

.form-group {
  display: flex;
  flex-direction: column;
  gap: $spacing-8;

  &__label {
    font-size: $font-size-300;
    line-height: $line-height-300;
    font-weight: $font-weight-medium;

    @include themify {
      color: themed('text-secondary');
    }
  }

  &__label-optional {
    font-size: $font-size-300;
    line-height: $line-height-300;
    font-weight: $font-weight-regular;

    @include themify {
      color: themed('text-tertiary');
    }
  }

  &__input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
  }

  &__input-prefix {
    position: absolute;
    left: $spacing-12;
    font-size: $font-size-300;
    line-height: $line-height-300;
    pointer-events: none;
    z-index: 1;

    @include themify {
      color: themed('text-secondary');
    }

    &::after {
      content: '\00a0';
    }
  }

  &__input--with-prefix {
    padding-left: calc(
      #{$spacing-12} + #{$spacing-24} + #{$spacing-8}
    ) !important;
  }
}

// -----------------------------------------------------------------------------
// DIALOGS - Estilo mejorado
// -----------------------------------------------------------------------------

.cash-movements-dialog {
  max-width: 500px;
  padding: 0;

  @include themify {
    background-color: themed('surface-card');
    border: 1px solid themed('border-subtle');
  }

  // Dialog header styling
  .radix-dialog__header,
  [data-slot='dialog-header'] {
    padding: $spacing-20 $spacing-24;
    border-bottom: 1px solid transparent;

    @include themify {
      border-bottom-color: themed('border-subtle');
      background-color: themed('bg-secondary');
    }
  }

  .radix-dialog__title,
  [data-slot='dialog-title'] {
    font-size: $font-size-500;
    font-weight: $font-weight-semibold;
    margin-bottom: $spacing-4;

    @include themify {
      color: themed('text-primary');
    }
  }

  .radix-dialog__description,
  [data-slot='dialog-description'] {
    font-size: $font-size-300;
    margin-top: $spacing-4;

    @include themify {
      color: themed('text-secondary');
    }
  }

  .dialog-form {
    display: flex;
    flex-direction: column;
    gap: $spacing-20;
    padding: $spacing-24;
  }

  // Dialog footer styling
  .radix-dialog__footer,
  [data-slot='dialog-footer'] {
    display: flex;
    justify-content: flex-end;
    gap: $spacing-12;
    padding: $spacing-16 $spacing-24;
    border-top: 1px solid transparent;

    @include themify {
      border-top-color: themed('border-subtle');
      background-color: themed('bg-secondary');
    }
  }

  // Void dialog specific styles
  &--void {
    .text-error {
      color: $error-100;
    }

    .radix-dialog__header,
    [data-slot='dialog-header'] {
      @include themify {
        background-color: rgba($error-100, 0.05);
        border-bottom-color: rgba($error-100, 0.15);
      }
    }

    // Form group within void dialog
    > .form-group {
      padding: $spacing-4 $spacing-24 $spacing-16;
    }
  }
}

.void-summary {
  padding: $spacing-16;
  border-radius: $border-radius-medium;
  display: flex;
  flex-direction: column;
  gap: $spacing-12;
  margin: $spacing-4 $spacing-24;

  @include themify {
    background-color: rgba($error-100, 0.05);
    border: 1px solid rgba($error-100, 0.15);
  }

  &__row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: $spacing-16;

    > span:first-child {
      font-size: $font-size-300;
      font-weight: $font-weight-medium;

      @include themify {
        color: themed('text-secondary');
      }
    }

    > span:last-child,
    > strong {
      font-size: $font-size-300;

      @include themify {
        color: themed('text-primary');
      }
    }

    > strong {
      font-weight: $font-weight-semibold;
    }
  }
}

// -----------------------------------------------------------------------------
// SEGMENTED CONTROL (dentro de diálogos)
// -----------------------------------------------------------------------------

.cash-movements-dialog {
  .segmented-control {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    padding: $spacing-4;
    border-radius: $border-radius-medium;
    border: none;
    gap: 0;

    @include themify {
      background-color: themed('bg-secondary');
    }
  }

  .segmented-control__indicator {
    display: none;
  }

  .segmented-control__option {
    padding: $spacing-8 $spacing-16;
    font-size: $font-size-300;
    font-weight: $font-weight-medium;
    border-radius: $border-radius-small;
    background: transparent;
    @include transition((background-color, color, box-shadow));

    @include themify {
      color: themed('text-secondary');
    }

    &:hover:not(:disabled):not(.segmented-control__option--active) {
      @include themify {
        color: themed('text-primary');
        background-color: rgba(themed('text-primary'), 0.06);
      }
    }

    &--active {
      box-shadow: $shadow-2;

      @include themify {
        background-color: $brand-120 !important;
        color: $brand-30 !important;
      }
    }
  }

  // ---------------------------------------------------------------------------
  // SELECT TRIGGER STYLING
  // ---------------------------------------------------------------------------

  button[role='combobox'] {
    width: 100%;
    padding: $spacing-12 $spacing-12;
    font-size: $font-size-300;
    border-radius: $border-radius-medium;
    border: 1px solid;
    @include transition((border-color, background-color, box-shadow));

    @include themify {
      background-color: themed('bg-primary');
      border-color: themed('border-default');
      color: themed('text-primary');

      &:hover:not(:disabled) {
        border-color: themed('border-strong');
      }

      &:focus-visible {
        outline: 2px solid $brand-100;
        outline-offset: 2px;
        border-color: $brand-100;
      }

      &[data-placeholder] {
        color: themed('text-tertiary');
      }
    }
  }
}

// -----------------------------------------------------------------------------
// SELECT CONTENT (Portal - fuera del modal)
// -----------------------------------------------------------------------------

[data-radix-popper-content-wrapper] {
  z-index: 10000 !important; // Por encima del modal (z-index: 50)

  [role='listbox'] {
    max-height: 280px;
    overflow-y: auto;
    padding: $spacing-4;
    border-radius: $border-radius-medium;
    box-shadow: $shadow-16;
    border: 1px solid;
    background-color: #ffffff !important;

    @include themify {
      background-color: themed('bg-primary') !important;
      border-color: themed('border-subtle');
    }

    [role='option'] {
      padding: $spacing-8 $spacing-12;
      font-size: $font-size-300;
      border-radius: $border-radius-small;
      cursor: pointer;
      @include transition((background-color, color));

      @include themify {
        color: themed('text-primary');

        &:hover {
          background-color: themed('bg-secondary');
        }

        &[data-highlighted] {
          background-color: themed('bg-tertiary');
          outline: none;
        }

        &[data-state='checked'] {
          background-color: $brand-120;
          color: $brand-30;
          font-weight: $font-weight-medium;
        }
      }
    }
  }
}
