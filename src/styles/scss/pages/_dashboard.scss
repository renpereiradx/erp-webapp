@use '../abstracts' as *;

.dashboard {
  flex: 1;
  width: 100%;
  max-width: 1440px;
  margin: 0 auto;
  padding: $spacing-24 $spacing-16;
  overflow-y: auto;

  @include respond-to(sm) {
    padding: $spacing-32 $spacing-24;
  }

  @include respond-to(lg) {
    padding: $spacing-32;
  }

  // ---------------------------------------------------------------------------
  // Header Section
  // ---------------------------------------------------------------------------
  &__header {
    display: flex;
    flex-direction: column;
    gap: $spacing-16;
    margin-bottom: $spacing-32;

    @include respond-to(md) {
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }
  }

  &__titles {
    display: flex;
    flex-direction: column;
    gap: $spacing-4;
  }

  &__title {
    @include heading-2;
    margin: 0;
    
    @include themify {
      color: themed('text-primary');
    }
  }

  &__subtitle {
    @include body-small;
    font-weight: $font-weight-medium;
    
    @include themify {
      color: themed('text-secondary');
    }
  }

  &__actions {
    display: flex;
    align-items: center;
    gap: $spacing-12;
  }

  // ---------------------------------------------------------------------------
  // Grid Layouts
  // ---------------------------------------------------------------------------
  &__kpi-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: $spacing-24;
    margin-bottom: $spacing-32;

    @include respond-to(sm) {
      grid-template-columns: repeat(2, 1fr);
    }

    @include respond-to(lg) {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  &__main-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: $spacing-24;
    margin-bottom: $spacing-32;

    @include respond-to(lg) {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  &__bottom-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: $spacing-24;

    @include respond-to(lg) {
      grid-template-columns: repeat(2, 1fr);
    }
  }



  // Grid Spans
  .col-span-8 { @include respond-to(lg) { grid-column: span 8; } }
  .col-span-4 { @include respond-to(lg) { grid-column: span 4; } }
  .col-span-6 { @include respond-to(lg) { grid-column: span 6; } }
  .col-span-12 { grid-column: 1 / -1; }

  .lg\:col-span-2 {
    @include respond-to(lg) {
      grid-column: span 2 / span 2;
    }
  }

  // ---------------------------------------------------------------------------
  // Components for Dashboard
  // ---------------------------------------------------------------------------
  
  // Overrides for Dashboard Cards
  .card {
     padding: $spacing-24; 
     border-radius: $spacing-12; // rounded-xl
     transition: box-shadow $duration-fast $ease-ease-in-out;
     border: 1px solid transparent;
     
     @include themify {
       background-color: themed('bg-primary');
       border-color: themed('border-subtle');
       box-shadow: $shadow-fluent;
     }

     &:hover {
       @include themify {
         box-shadow: $shadow-fluent-hover;
       }
     }
     
     .card__header {
        border-bottom: none;
        padding-bottom: 0;
        margin-bottom: $spacing-20;
     }

     &.chart-card {
        display: flex;
        flex-direction: column;
        padding: $spacing-24;
     }
  }

  // Chart Legend
  .chart-card__legend {
    display: flex;
    align-items: center;
    gap: $spacing-16;

    &-item {
      display: flex;
      align-items: center;
      gap: $spacing-8;
      
      .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }
      
      .label {
        font-size: $font-size-200;
        color: var(--text-secondary);
        font-weight: $font-weight-medium;
      }
    }
  }

  // KPI Cards
  .kpi-card {
    display: flex;
    flex-direction: column;
    gap: $spacing-16;
    padding: $spacing-24;
    height: auto; // Let it grow
    min-height: 140px;

    &__header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      width: 100%;
    }

    &__icon {
      padding: $spacing-8;
      border-radius: $border-radius-large;
      display: flex;
      align-items: center;
      justify-content: center;

      &--blue {
        background-color: rgba(#3b82f6, 0.1);
        color: #3b82f6;
      }
      &--orange {
        background-color: rgba(#f97316, 0.1);
        color: #f97316;
      }
      &--green {
        background-color: rgba(#10b981, 0.1);
        color: #10b981;
      }
      &--purple {
        background-color: rgba(#a855f7, 0.1);
        color: #a855f7;
      }
    }

    &__trend {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px $spacing-8;
      border-radius: $border-radius-medium;
      font-size: $font-size-100;
      font-weight: $font-weight-bold;

      &--up {
        background-color: #ecfdf5;
        color: #059669;
        @include themify {
          background-color: rgba(#059669, 0.1); // Using hardcoded for better contrast with spec
          color: #059669;
        }
      }
      &--down {
        background-color: #fef2f2;
        color: #dc2626;
        @include themify {
          background-color: rgba(#dc2626, 0.1);
          color: #dc2626;
        }
      }
    }

    &__label {
      font-size: $font-size-300;
      font-weight: $font-weight-medium;
      margin-bottom: $spacing-4;
      @include themify {
        color: themed('text-secondary');
      }
    }

    &__value {
      font-size: $font-size-800; // 24px
      font-weight: $font-weight-bold;
      margin: 0;
      letter-spacing: -0.025em;
      @include themify {
        color: themed('text-primary');
      }
    }
  }

  // Operation Cards (Inventory/Cash)
  .operation-card {
    position: relative;
    overflow: hidden;
    padding: $spacing-24;
    display: flex;
    flex-direction: column;
    
    &__content {
      position: relative;
      z-index: 2;
    }

    &__header {
      display: flex;
      align-items: center;
      gap: $spacing-12;
      margin-bottom: $spacing-16;
    }

    &__icon {
      padding: $spacing-8;
      border-radius: $border-radius-large;
      display: flex;
      align-items: center;
      justify-content: center;
      
      &--orange {
        background-color: rgba(#f97316, 0.1);
        color: #f97316;
      }
      &--green {
        background-color: rgba(#10b981, 0.1);
        color: #10b981;
      }
    }

    &__title {
      font-size: $font-size-400;
      font-weight: $font-weight-bold;
      margin: 0;
      @include themify {
        color: themed('text-primary');
      }
    }

    &__deco {
      position: absolute;
      top: -1rem;
      right: -1rem;
      width: 6rem;
      height: 6rem;
      border-radius: 50%; // Rounded circle like spec
      z-index: 1;
      opacity: 0.1;
      transition: transform $duration-normal $ease-ease-in-out;
      
      &--orange { background-color: #f97316; }
      &--green { background-color: #10b981; }
    }

    &:hover &__deco {
      transform: scale(1.1);
    }

    &__alert {
      margin-top: $spacing-16;
      padding: $spacing-12;
      border-radius: $border-radius-large;
      display: flex;
      align-items: center;
      gap: $spacing-8;
      font-size: $font-size-300;
      font-weight: $font-weight-semibold;
      
      @include themify {
        background-color: rgba(themed('state-error'), 0.05);
        color: themed('state-error');
        border: 1px solid rgba(themed('state-error'), 0.1);
      }
    }
  }

  // Finance Overview
  .finance-group {
    &__header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: $spacing-8;
    }

    &__label {
      font-size: $font-size-300;
      font-weight: $font-weight-semibold;
      @include themify { color: themed('text-secondary'); }
    }

    &__value {
      font-size: $font-size-700;
      font-weight: $font-weight-bold;
      margin: 0;
    }

    &__trend {
      font-size: $font-size-300;
      font-weight: $font-weight-medium;
      
      &--positive { color: #059669; }
      &--neutral { color: var(--text-tertiary); }
    }
  }

  // Activity/Alert Items
  .activity-list {
    max-height: 400px;
    overflow-y: auto;
  }

  .activity-item {
     display: flex;
     gap: $spacing-16;
     padding: $spacing-16;
     border-bottom: 1px solid;
     transition: background-color $duration-fast;
     cursor: pointer;
     
     @include themify {
       border-color: themed('border-subtle');
     }
     
     &:hover {
       @include themify {
         background-color: themed('bg-hover');
       }
     }
     
     &:last-child {
       border-bottom: none;
     }

     &__icon {
       margin-top: $spacing-4;
       width: 32px;
       height: 32px;
       border-radius: 50%;
       display: flex;
       align-items: center;
       justify-content: center;
       flex-shrink: 0;

       &--error {
         background-color: rgba(#dc2626, 0.1);
         color: #dc2626;
       }
       &--success {
         background-color: rgba(#059669, 0.1);
         color: #059669;
       }
       &--info {
         background-color: rgba(#3b82f6, 0.1);
         color: #3b82f6;
       }
     }

     &__content { flex: 1; }
     
     &__header {
       display: flex;
       justify-content: space-between;
       align-items: flex-start;
       margin-bottom: 2px;
     }

     &__title { 
       font-size: $font-size-300; 
       font-weight: $font-weight-bold; 
       margin: 0;
       transition: color $duration-fast;
     }
     
     &:hover &__title {
       @include themify { color: themed('accent-primary'); }
     }

     &__desc { 
       font-size: $font-size-300; 
       color: var(--text-secondary); 
       margin-top: 2px;
     }

     &__time { 
       font-size: $font-size-200; 
       color: var(--text-tertiary); 
       white-space: nowrap; 
     }
  }

  .badge-group {
    display: flex;
    align-items: center;
    gap: $spacing-8;
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: .5; }
  }
}
