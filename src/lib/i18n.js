// Simple i18n utility (extensible)
// Usage: const { t, lang, setLang } = useI18n(); t('products.title')
import { useState, useCallback } from 'react';

const DICTIONARY = {
  es: {
    'products.title': 'Gestión de Productos',
    'products.new': 'Nuevo Producto',
    'products.loading': 'Cargando productos...',
    'products.error.loading': 'Error al cargar',
    'products.retry': 'Reintentar',
    'products.search.db': 'Buscar en Base de Datos',
    'products.search.placeholder': 'Buscar por nombre o ID...',
    'products.search.placeholder_id': 'Buscar por ID de producto...',
    'products.search': 'Buscar',
    'products.clear': 'Limpiar',
    'products.bulk.activate': 'Activar',
    'products.bulk.deactivate': 'Desactivar',
    'products.bulk.clear': 'Limpiar',
    'products.inline.save': 'Guardar',
    'products.inline.cancel': 'Cancelar',
    'products.create_first': 'Crear Primer Producto',
    'products.no_products_loaded': 'No hay productos cargados',
    'products.no_results': 'No se encontraron productos',
    'products.no_results_for': 'No hay productos que coincidan con "{term}"',
    'products.search.help1': 'Puedes buscar por nombre (ej: "Puma") o por ID completo (ej: "bcYdWdKNR")',
    'products.search.help2': 'Búsqueda automática: mínimo {minChars} caracteres. Atajo: "/" para enfocar.',
    'products.page_size_label': 'Productos por página:',
    'validation.required': 'Requerido',
    'validation.price.invalid': 'Precio inválido',
    'validation.price.invalid.short': 'Inválido',
    'validation.stock.invalid': 'Stock inválido',
    'validation.stock.invalid.short': 'Inválido',
    'field.name': 'Nombre',
    'field.price': 'Precio',
    'field.unit_price': 'Precio/Unidad:',
    'field.stock': 'Stock',
    'field.no_name': 'Sin nombre',
    'field.code': 'Código',
    'field.id': 'ID',
    'field.category': 'Categoría',
    'action.view': 'Ver',
    'action.edit': 'Editar',
    'action.inline': 'Inline',
    'action.delete_product': 'Eliminar producto',
    'badge.low_stock': 'Bajo stock',
    'badge.low_stock.upper': 'BAJO STOCK',

    // Clients - MVP strings
    'clients.title': 'Clientes',
    'clients.action.primary': 'Nuevo Cliente',
    'clients.error.generic': 'Error al procesar la solicitud. Por favor, intente nuevamente.',

    // Error hints
    'errors.hint.INTERNAL': 'Problema interno, intenta más tarde.',
    'errors.hint.NETWORK': 'Verifica tu conexión a internet.',
    'errors.hint.UNAUTHORIZED': 'Reinicia sesión para continuar.',
    'errors.hint.NOT_FOUND': 'El recurso no existe o fue eliminado.',
    'errors.hint.VALIDATION': 'Revisa los datos ingresados.',
    'errors.hint.RATE_LIMIT': 'Demasiadas solicitudes, espera e intenta de nuevo.',
    'errors.hint.CONFLICT': 'Conflicto de estado, refresca los datos.',
    'errors.hint.UNKNOWN': 'Ocurrió un error inesperado.',

    'errors.toast.copy_code': 'Copiar código',
    'errors.toast.retry': 'Reintentar',
    'errors.toast.diagnostics': 'Diagnóstico',

    // Añadir keys adicionales para modales
    'products.edit_title': 'Editar Producto',
    'products.new_title': 'Nuevo Producto',
    'products.name_placeholder': 'Ingrese el nombre del producto',
    'products.description_label': 'Descripción',
    'products.description_placeholder': 'Descripción detallada del producto...',
    'products.category_label': 'Categoría *',
    'products.categories_loading': 'Cargando categorías...',
    'products.categories_error': 'Error al cargar categorías',
    'products.categories_none': 'No hay categorías disponibles',
    'products.categories_select': 'Seleccionar categoría...',
    'products.type_label': 'Tipo de Producto',
    'products.active_label': 'Producto Activo',
    'products.cancel': 'Cancelar',
    'products.saving': 'Guardando...',
    'products.categories_first': 'Cargar categorías primero',
    'products.save': 'Guardar',
    'products.name_placeholder': 'Ingrese el nombre del producto',

    'products.delete_title': 'Eliminar Producto',
    'products.delete_subtitle': 'Esta acción no se puede deshacer',
    'products.id_label': 'ID Producto',
    'products.info_title': 'Información Importante',
    'products.delete_hint.soft': 'El producto será marcado como eliminado (soft delete)',
    'products.deleting': 'Eliminando...',
    'products.delete_action': 'Eliminar',

    // Claves adicionales para ProductDetailModal
    'products.no_description': 'Sin descripción disponible',
    'products.error.load_details': 'Error al cargar detalles del producto',
    'products.description_updated': 'Descripción actualizada exitosamente',
    'products.error.save_description': 'Error al guardar descripción',
    'products.prices_updated': 'Precios actualizados exitosamente',
    'products.error.save_price': 'Error al guardar precio',
    'products.stock_updated': 'Stock actualizado exitosamente',
    'products.error.save_stock': 'Error al guardar stock',
    'products.id_label': 'ID',
    'products.tabs.info': 'Información',
    'products.tabs.description': 'Descripción',
    'products.tabs.price': 'Precios',
    'products.tabs.stock': 'Stock',
    'products.info_general': 'Información General',
    'products.description_info': 'Información de Descripción',
    'products.description_heading': 'Descripción del Producto',
    'products.price_info': 'Información de Precios',
    'products.configure_prices': 'Configurar Precios',
    'products.stock_info': 'Información de Stock',
    'products.configure_stock': 'Configurar Inventario',
    'products.enriched_title': 'Producto con datos enriquecidos',
    'products.unit_pricing_title': 'Producto con precios por unidad (kg, caja, etc.)',
    'products.multiple_units_title': 'Múltiples unidades disponibles',
    'products.list_label': 'Listado de productos',
    'products.item_aria': 'Producto {nameOrId}',

    // Announcements
    'announce.error_validation': 'Error de validación: {msg}',
    'announce.error_network': 'Error de red: {msg}',
    'announce.results_for': 'Resultados: {total} para "{term}"',
    'announce.total_results': 'Total resultados: {total}',

    'errors.code_label': 'Código: {code}',
    'errors.hint.label': 'Sugerencia',

    // Modal translations
    'modal.close': 'Cerrar modal',
    'modal.loading': 'Cargando...',
    'modal.cancel': 'Cancelar',
    'modal.confirm': 'Confirmar',
    'modal.processing': 'Procesando...',

    // Client modals
    'client.modal.edit_subtitle': 'Modifica la información del cliente',
    'client.modal.create_subtitle': 'Ingresa los datos del nuevo cliente',

    // Supplier modals  
    'supplier.modal.edit_subtitle': 'Modifica los datos del proveedor',
    'supplier.modal.create_subtitle': 'Registra un nuevo proveedor en el sistema',

    // Reservation modals
    'reservations.modal.edit_subtitle': 'Modifica los detalles de la reserva',
    'reservations.modal.create_subtitle': 'Programa una nueva reserva de servicio',

    // Delete confirmations
    'client.delete.title': 'Eliminar Cliente',
    'client.delete.message': 'Esta acción eliminará permanentemente al cliente "{name}" y no se puede deshacer.',
    'client.delete.confirm': 'Eliminar Cliente',
    'supplier.delete.title': 'Eliminar Proveedor',
    'supplier.delete.message': 'Esta acción eliminará permanentemente al proveedor "{name}" y no se puede deshacer.',
    'supplier.delete.confirm': 'Eliminar Proveedor',
  },
  en: {
    'products.title': 'Product Management',
    'products.new': 'New Product',
    'products.loading': 'Loading products...',
    'products.error.loading': 'Load error',
    'products.retry': 'Retry',
    'products.search.db': 'Search in Database',
    'products.search.placeholder': 'Search by name or ID...',
    'products.search': 'Search',
    'products.clear': 'Clear',
    'products.bulk.activate': 'Activate',
    'products.bulk.deactivate': 'Deactivate',
    'products.bulk.clear': 'Clear',
    'products.inline.save': 'Save',
    'products.inline.cancel': 'Cancel',
    'products.create_first': 'Create First Product',
    'products.no_products_loaded': 'No products loaded',
    'products.no_results': 'No products found',
    'products.no_results_for': 'No products matched "{term}"',
    'products.search.help1': 'You can search by name (e.g. "Puma") or by full ID (e.g. "bcYdWdKNR")',
    'products.search.help2': 'Auto-search: minimum {minChars} characters. Shortcut: "/" to focus.',
    'products.page_size_label': 'Products per page:',
    'validation.required': 'Required',
    'validation.price.invalid': 'Invalid price',
    'validation.price.invalid.short': 'Invalid',
    'validation.stock.invalid': 'Invalid stock',
    'validation.stock.invalid.short': 'Invalid',
    'field.name': 'Name',
    'field.price': 'Price',
    'field.unit_price': 'Unit Price:',
    'field.stock': 'Stock',
    'field.no_name': 'No name',
    'field.code': 'Code',
    'field.id': 'ID',
    'field.category': 'Category',
    'action.view': 'View',
    'action.edit': 'Edit',
    'action.inline': 'Inline',
    'action.delete_product': 'Delete product',
    'badge.low_stock': 'Low stock',
    'badge.low_stock.upper': 'LOW STOCK',

    // Error hints
    'errors.hint.INTERNAL': 'Internal server issue, try again later.',
    'errors.hint.NETWORK': 'Check your internet connection.',
    'errors.hint.UNAUTHORIZED': 'Please sign in again to continue.',
    'errors.hint.NOT_FOUND': 'The resource does not exist or was removed.',
    'errors.hint.VALIDATION': 'Check the entered data.',
    'errors.hint.RATE_LIMIT': 'Too many requests, wait and retry.',
    'errors.hint.CONFLICT': 'State conflict, refresh the data.',
    'errors.hint.UNKNOWN': 'An unexpected error occurred.',

    'errors.toast.copy_code': 'Copy code',
    'errors.toast.retry': 'Retry',
    'errors.toast.diagnostics': 'Diagnostics',

    'products.edit_title': 'Edit Product',
    'products.new_title': 'New Product',
    'products.name_placeholder': 'Enter product name',
    'products.description_label': 'Description',
    'products.description_placeholder': 'Detailed product description...',
    'products.category_label': 'Category *',
    'products.categories_loading': 'Loading categories...',
    'products.categories_error': 'Error loading categories',
    'products.categories_none': 'No categories available',
    'products.categories_select': 'Select category...',
    'products.type_label': 'Product type',
    'products.active_label': 'Product active',
    'products.cancel': 'Cancel',
    'products.saving': 'Saving...',
    'products.categories_first': 'Load categories first',
    'products.save': 'Save',
    'products.name_placeholder': 'Enter product name',

    'products.delete_title': 'Delete Product',
    'products.delete_subtitle': 'This action cannot be undone',
    'products.id_label': 'Product ID',
    'products.info_title': 'Important information',
    'products.delete_hint.soft': 'The product will be marked as deleted (soft delete)',
    'products.deleting': 'Deleting...',
    'products.delete_action': 'Delete',

    // EN
    'products.no_description': 'No description available',
    'products.error.load_details': 'Error loading product details',
    'products.description_updated': 'Description updated successfully',
    'products.error.save_description': 'Error saving description',
    'products.prices_updated': 'Prices updated successfully',
    'products.error.save_price': 'Error saving price',
    'products.stock_updated': 'Stock updated successfully',
    'products.error.save_stock': 'Error saving stock',
    'products.id_label': 'ID',
    'products.tabs.info': 'Information',
    'products.tabs.description': 'Description',
    'products.tabs.price': 'Prices',
    'products.tabs.stock': 'Stock',
    'products.info_general': 'General Information',
    'products.description_info': 'Description Information',
    'products.description_heading': 'Product Description',
    'products.price_info': 'Price Information',
    'products.configure_prices': 'Configure Prices',
    'products.stock_info': 'Stock Information',
    'products.configure_stock': 'Configure Inventory',
    'products.enriched_title': 'Product with enriched data',
    'products.unit_pricing_title': 'Product with unit pricing (kg, box, etc.)',
    'products.multiple_units_title': 'Multiple units available',
    'products.list_label': 'Product list',
    'products.item_aria': 'Product {nameOrId}',

    // Announcements
    'announce.error_validation': 'Validation error: {msg}',
    'announce.error_network': 'Network error: {msg}',
    'announce.results_for': 'Results: {total} for "{term}"',
    'announce.total_results': 'Total results: {total}',

    'errors.code_label': 'Error code: {code}',
    'errors.hint.label': 'Hint',
  }
};

// Add additional product-level messages and banners
// (kept after DICTIONARY to avoid large duplicate blocks)
Object.assign(DICTIONARY.es, {
  'products.offline_banner': 'Estás sin conexión. Los datos pueden estar desactualizados.',
  'products.auto_login_success': 'Auto-login exitoso! Recargando categorías...',
  'products.auto_login_error': 'Error en auto-login',
  'products.operation_success': 'Operación completada exitosamente',
  'products.deleted_success': 'Producto "{name}" eliminado exitosamente',
  'products.updated_notice': 'Producto {id} actualizado',
  'products.subtitle': 'Administra tu inventario con la Business Management API',
  'products.filter.current_results_title': 'Filtrar Resultados Actuales',
  'products.filter.name_placeholder': 'Filtrar por nombre...',
  'products.filter.all_categories': 'Todas las categorías',
  'products.filter.all_status': 'Todos los estados',
  'products.filter.status.active': 'Activos',
  'products.filter.status.inactive': 'Inactivos',
  'products.filter.products_label': 'Productos',
  'products.bulk.selected_count': '{count} seleccionados',
  'products.pagination.showing_page_count': 'Mostrando {shown} de {pageCount} productos en esta página',
  'products.pagination.search_prefix': 'Búsqueda:',
  'products.pagination.by_id': 'por ID',
  'products.pagination.by_name': 'por nombre',
  'products.pagination.total_found': 'Total encontrados: {total}',
  'products.pagination.first': 'Primera',
  'products.pagination.prev': 'Anterior',
  'products.pagination.next': 'Siguiente',
  'products.pagination.last': 'Última',
  'products.pagination.page_of': 'Página {page} de {totalPages}',
  // Internal labels additions (purchases stats & booking selectors)
  'purchases.stats.products': 'Productos',
  'purchases.stats.quantity': 'Cantidad',
  'purchases.stats.subtotal': 'Subtotal',
  'purchases.stats.total': 'Total',
  'booking.reservation.service.label': 'Servicio',
  'booking.reservation.select_service.placeholder': 'Seleccionar servicio...',
  'booking.reservation.duration.minutes': '{minutes}min',
});
Object.assign(DICTIONARY.en, {
  'products.offline_banner': 'You are offline. Data may be stale.',
  'products.auto_login_success': 'Auto-login successful! Reloading categories...',
  'products.auto_login_error': 'Auto-login error',
  'products.operation_success': 'Operation completed successfully',
  'products.deleted_success': 'Product "{name}" deleted successfully',
  'products.updated_notice': 'Product {id} updated',
  'products.subtitle': 'Manage your inventory with the Business Management API',
  'products.filter.current_results_title': 'Filter Current Results',
  'products.filter.name_placeholder': 'Filter by name...',
  'products.filter.all_categories': 'All categories',
  'products.filter.all_status': 'All statuses',
  'products.filter.status.active': 'Active',
  'products.filter.status.inactive': 'Inactive',
  'products.filter.products_label': 'Products',
  'products.bulk.selected_count': '{count} selected',
  'products.pagination.showing_page_count': 'Showing {shown} of {pageCount} products on this page',
  'products.pagination.search_prefix': 'Search:',
  'products.pagination.by_id': 'by ID',
  'products.pagination.by_name': 'by name',
  'products.pagination.total_found': 'Total found: {total}',
  'products.pagination.first': 'First',
  'products.pagination.prev': 'Previous',
  'products.pagination.next': 'Next',
  'products.pagination.last': 'Last',
  'products.pagination.page_of': 'Page {page} of {totalPages}',
  // Internal labels additions (purchases stats & booking selectors)
  'purchases.stats.products': 'Products',
  'purchases.stats.quantity': 'Quantity',
  'purchases.stats.subtotal': 'Subtotal',
  'purchases.stats.total': 'Total',
  'booking.reservation.service.label': 'Service',
  'booking.reservation.select_service.placeholder': 'Select service...',
  'booking.reservation.duration.minutes': '{minutes}min',
});

// Login Page
Object.assign(DICTIONARY.es, {
  'login.access': 'Acceso al sistema',
  'login.sign_in': 'Iniciar Sesión',
  'login.credentials.prompt': 'Ingresa tus credenciales para continuar',
  'login.test_credentials.title': 'Credenciales de prueba:',
  'login.username.label': 'Usuario o Email',
  'login.username.placeholder': 'Ingresa tu usuario',
  'login.password.label': 'Contraseña',
  'login.password.placeholder': 'Ingresa tu contraseña',
  'login.remember': 'Recordar sesión',
  'login.submit': 'Iniciar Sesión',
  'login.processing': 'Iniciando...',
  'login.forgot_password': '¿Olvidaste tu contraseña?',
  'login.no_account': '¿No tienes cuenta?',
  'login.register': 'Regístrate',
  'login.footer.rights': 'Todos los derechos reservados.',
  'login.validation.username.required': 'El email o usuario es requerido',
  'login.validation.username.min': 'Debe tener al menos 3 caracteres',
  'login.validation.password.required': 'La contraseña es requerida',
  'login.validation.password.min': 'La contraseña debe tener al menos 6 caracteres',
  'login.error.failed_examples': 'Login fallido. Prueba: admin/admin123, test/test123, demo/demo123, user/user123',
});
Object.assign(DICTIONARY.en, {
  'login.access': 'System Access',
  'login.sign_in': 'Sign In',
  'login.credentials.prompt': 'Enter your credentials to continue',
  'login.test_credentials.title': 'Test credentials:',
  'login.username.label': 'Username or Email',
  'login.username.placeholder': 'Enter your username',
  'login.password.label': 'Password',
  'login.password.placeholder': 'Enter your password',
  'login.remember': 'Remember session',
  'login.submit': 'Sign In',
  'login.processing': 'Signing in...',
  'login.forgot_password': 'Forgot your password?',
  'login.no_account': "Don't have an account?",
  'login.register': 'Register',
  'login.footer.rights': 'All rights reserved.',
  'login.validation.username.required': 'Username or email is required',
  'login.validation.username.min': 'Must be at least 3 characters',
  'login.validation.password.required': 'Password is required',
  'login.validation.password.min': 'Password must be at least 6 characters',
  'login.error.failed_examples': 'Login failed. Try: admin/admin123, test/test123, demo/demo123, user/user123',
});

// Purchases Page
Object.assign(DICTIONARY.es, {
  'purchases.title': 'Compras',
  'purchases.subtitle': 'Administra compras a proveedores, controla inventario y órdenes de compra',
  'purchases.tab.new': 'Nueva Compra',
  'purchases.tab.list': 'Lista de Compras',
  'purchases.config.title': 'Configuración de Compra',
  'purchases.config.expected_delivery': 'Fecha de Entrega Esperada',
  'purchases.config.payment_terms': 'Términos de Pago',
  'purchases.config.delivery_method': 'Método de Entrega',
  'purchases.config.notes': 'Notas',
  'purchases.config.notes.placeholder': 'Notas adicionales sobre la compra...',
  'purchases.supplier.info': 'Información del Proveedor',
  'purchases.products.title': 'Productos',
  'purchases.items.title': 'Items del Pedido ({count})',
  'purchases.actions.save': 'Crear Compra',
  'purchases.actions.saving': 'Creando Compra...',
  'purchases.clear': 'Limpiar Todo',
  'purchases.todo.title': 'Por completar:',
  'purchases.todo.supplier': 'Seleccionar proveedor',
  'purchases.todo.items': 'Agregar productos',
  'purchases.todo.valid_items': 'Verificar cantidades',
  'purchases.empty.title': 'Comienza una compra',
  'purchases.empty.description': 'Selecciona un proveedor para empezar o crea uno nuevo.',
  'purchases.empty.action': 'Seleccionar Proveedor',
  'purchases.create': 'Crear Compra',
  'purchases.saving': 'Creando Compra...',
});
Object.assign(DICTIONARY.en, {
  'purchases.title': 'Purchases',
  'purchases.subtitle': 'Manage supplier purchases, inventory control and purchase orders',
  'purchases.tab.new': 'New Purchase',
  'purchases.tab.list': 'Purchase List',
  'purchases.config.title': 'Purchase Configuration',
  'purchases.config.expected_delivery': 'Expected Delivery Date',
  'purchases.config.payment_terms': 'Payment Terms',
  'purchases.config.delivery_method': 'Delivery Method',
  'purchases.config.notes': 'Notes',
  'purchases.config.notes.placeholder': 'Additional notes about the purchase...',
  'purchases.supplier.info': 'Supplier Information',
  'purchases.products.title': 'Products',
  'purchases.items.title': 'Order Items ({count})',
  'purchases.actions.save': 'Create Purchase',
  'purchases.actions.saving': 'Creating Purchase...',
  'purchases.clear': 'Clear All',
  'purchases.todo.title': 'To complete:',
  'purchases.todo.supplier': 'Select supplier',
  'purchases.todo.items': 'Add products',
  'purchases.todo.valid_items': 'Verify quantities',
  'purchases.empty.title': 'Start a purchase',
  'purchases.empty.description': 'Select a supplier to begin or create a new one.',
  'purchases.empty.action': 'Select Supplier',
  'purchases.create': 'Create Purchase',
  'purchases.saving': 'Creating Purchase...',
});

// Booking & Sales Page
Object.assign(DICTIONARY.es, {
  'booking.title': 'Reservas y Ventas',
  'booking.subtitle': 'Gestiona reservas de servicios y ventas de productos de forma integrada',
  'booking.tab.reservations': 'Reservas',
  'booking.tab.sales': 'Ventas',
  'booking.reservation.new': 'Nueva Reserva',
  'booking.reservation.service': 'Servicio',
  'booking.reservation.select_service': 'Seleccionar servicio...',
  'booking.reservation.summary': 'Resumen de Reserva',
  'booking.reservation.confirm': 'Confirmar Reserva',
  'booking.sales.new': 'Nueva Venta',
  'booking.sales.complete': 'Completar Venta',
  'booking.sales.summary': 'Resumen de Venta',
  'booking.common.processing': 'Procesando...',
  'booking.summary.service': 'Servicio:',
  'booking.summary.date': 'Fecha:',
  'booking.summary.time': 'Hora:',
  'booking.summary.total': 'Total:',
  'booking.summary.subtotal': 'Subtotal:',
  'booking.summary.tax': 'IVA (16%):',
  'booking.summary.items_count': '{count} artículos',

  // Login Page (Refactored)
  'login.title': 'Acceso al Sistema',
  'login.subtitle': 'Ingresa tus credenciales para continuar',
  'login.email_label': 'Email o Usuario',
  'login.email_placeholder': 'ej: admin',
  'login.password_label': 'Contraseña',
  'login.password_placeholder': 'ej: admin123',
  'login.submit': 'Iniciar Sesión',
  'login.loading': 'Iniciando Sesión...',
  'login.forgot_password': '¿Olvidaste tu contraseña?',
  'login.error.generic': 'Error: Credenciales incorrectas o problema del servidor.',

  // Dashboard Page
  'dashboard.title': 'Dashboard',
  'dashboard.error.title': 'Error al cargar el Dashboard',
  'dashboard.metrics.sales': 'Ventas Totales',
  'dashboard.metrics.clients': 'Clientes Activos',
  'dashboard.metrics.products': 'Productos Totales',
  'dashboard.metrics.orders': 'Pedidos Hoy',
  'dashboard.charts.sales': 'Ventas Mensuales',
  'dashboard.charts.categories': 'Categorías Populares',

  // Suppliers Page
  'supplier.title': 'Proveedores',
  'supplier.action.create': 'Nuevo Proveedor',
  'supplier.error.title': 'Error al cargar proveedores',
  'supplier.empty.title': 'No hay proveedores',
  'supplier.empty.message': 'Crea tu primer proveedor para empezar.',
  'supplier.modal.edit': 'Editar Proveedor',
  'supplier.modal.create': 'Crear Proveedor',

  // Settings Page
  'settings.title': 'Configuración',
  'settings.theme.title': 'Tema de Apariencia',
  'settings.theme.description': 'Selecciona el tema que mejor se adapte a tus preferencias.',
  'settings.language.title': 'Idioma',
  'settings.language.description': 'Próximamente: Opciones de idioma.',
  'settings.notifications.title': 'Notificaciones',
  'settings.notifications.description': 'Próximamente: Ajustes de notificaciones.',
});
Object.assign(DICTIONARY.en, {
  'booking.title': 'Bookings & Sales',
  'booking.subtitle': 'Manage service bookings and product sales in one place',
  'booking.tab.reservations': 'Bookings',
  'booking.tab.sales': 'Sales',
  'booking.reservation.new': 'New Booking',
  'booking.reservation.service': 'Service',
  'booking.reservation.select_service': 'Select service...',
  'booking.reservation.summary': 'Booking Summary',
  'booking.reservation.confirm': 'Confirm Booking',
  'booking.sales.new': 'New Sale',
  'booking.sales.complete': 'Complete Sale',
  'booking.sales.summary': 'Sale Summary',
  'booking.common.processing': 'Processing...',
  'booking.summary.service': 'Service:',
  'booking.summary.date': 'Date:',
  'booking.summary.time': 'Time:',
  'booking.summary.total': 'Total:',
  'booking.summary.subtotal': 'Subtotal:',
  'booking.summary.tax': 'VAT (16%):',
  'booking.summary.items_count': '{count} items',
});
// Clients & Suppliers internal labels
Object.assign(DICTIONARY.es, {
  'clients.stats.shown': 'CLIENTES MOSTRADOS',
  'suppliers.stats.shown': 'PROVEEDORES MOSTRADOS',
  'clients.card.document': 'DOCUMENTO:',
  'clients.card.contact': 'CONTACTO:',
      'clients.card.registered': 'REGISTRO:',

    // Clients - MVP strings from new page
    'client.title': 'Clientes',
    'client.action.create': 'Nuevo Cliente',
    'client.search.placeholder': 'Buscar cliente...',
    'client.error.title': 'Error al cargar clientes',
    'client.empty.title': 'Sin clientes',
    'client.empty.message': 'No hay clientes registrados todavía.',
    'client.modal.edit': 'EDITAR CLIENTE',
    'client.modal.create': 'CREAR CLIENTE',
    'field.email': 'EMAIL',
    'field.phone': 'TELÉFONO',
    'field.tax_id': 'RFC',
    'action.saving': 'Guardando...',
    'action.update': 'Actualizar',
    'action.cancel': 'Cancelar',
    'action.delete': 'Eliminar',

  'suppliers.card.ruc': 'RUC:',
  'suppliers.card.phone': 'TELÉFONO:',
  'suppliers.card.fax': 'FAX:',
  'suppliers.card.address': 'DIRECCIÓN:',
  'suppliers.card.registered': 'REGISTRO:',
});
Object.assign(DICTIONARY.en, {
  'clients.stats.shown': 'CLIENTS SHOWN',
  'suppliers.stats.shown': 'SUPPLIERS SHOWN',
  'clients.card.document': 'DOCUMENT:',
  'clients.card.contact': 'CONTACT:',
  'clients.card.registered': 'REGISTERED:',
  'suppliers.card.ruc': 'TAX ID:',
  'suppliers.card.phone': 'PHONE:',
  'suppliers.card.fax': 'FAX:',
  'suppliers.card.address': 'ADDRESS:',
  'suppliers.card.registered': 'REGISTERED:',
});

// Clients (placeholder i18n minimal)
Object.assign(DICTIONARY.es, {
  'clients.search.db': 'Buscar en Base de Datos',
  'clients.search.placeholder': 'Buscar por nombre, documento o ID...',
  'clients.search': 'Buscar',
  'clients.clear': 'Limpiar',
  'clients.page_size_label': 'Clientes por página:',
  'clients.filter.current_results_title': 'Filtrar Resultados Actuales',
  'clients.filter.name_placeholder': 'Filtrar por nombre...',
  'clients.filter.all_status': 'Todos los estados',
  'clients.filter.status.active': 'Activos',
  'clients.filter.status.inactive': 'Inactivos',
  'clients.pagination.showing_page_count': 'Mostrando {shown} de {total} clientes',
  'clients.pagination.first': 'Primera',
  'clients.pagination.prev': 'Anterior',
  'clients.pagination.next': 'Siguiente',
  'clients.pagination.last': 'Última',
  'clients.pagination.page_of': 'Página {page} de {totalPages}',
});
Object.assign(DICTIONARY.en, {
  'clients.search.db': 'Search in Database',
  'clients.search.placeholder': 'Search by name, document or ID...',
  'clients.search': 'Search',
  'clients.clear': 'Clear',
  'clients.page_size_label': 'Clients per page:',
  'clients.filter.current_results_title': 'Filter Current Results',
  'clients.filter.name_placeholder': 'Filter by name...',
  'clients.filter.all_status': 'All statuses',
  'clients.filter.status.active': 'Active',
  'clients.filter.status.inactive': 'Inactive',
  'clients.pagination.showing_page_count': 'Showing {shown} of {total} clients',
  'clients.pagination.first': 'First',
  'clients.pagination.prev': 'Previous',
  'clients.pagination.next': 'Next',
  'clients.pagination.last': 'Last',
  'clients.pagination.page_of': 'Page {page} of {totalPages}',
});

// Sales - MVP strings
Object.assign(DICTIONARY.es, {
  'sales.title': 'Ventas',
  'sales.subtitle': 'Gestiona las ventas de productos',
  'sales.new_sale': 'Nueva Venta',
  'sales.processing': 'Procesando...',
  'sales.complete': 'Completar Venta',
  'sales.summary.title': 'Resumen de Venta',
  'sales.summary.subtotal': 'Subtotal:',
  'sales.summary.tax': 'IVA (16%):',
  'sales.summary.total': 'Total:',
  'sales.summary.items': 'artículos',
  // Payment strings
  'sales.payment.title': 'Procesamiento de Pago',
  'sales.payment.method': 'Método de Pago',
  'sales.payment.amount_paid': 'Monto Pagado',
  'sales.payment.change': 'Cambio:',
  'sales.payment.total': 'Total a Pagar:',
  'sales.session.start': 'Iniciar Sesión de Ventas',
  'sales.session.end': 'Finalizar Sesión',
  'sales.session.active': 'Sesión Activa',
});

Object.assign(DICTIONARY.en, {
  'sales.title': 'Sales',
  'sales.subtitle': 'Manage product sales',
  'sales.new_sale': 'New Sale',
  'sales.processing': 'Processing...',
  'sales.complete': 'Complete Sale',
  'sales.summary.title': 'Sale Summary',
  'sales.summary.subtotal': 'Subtotal:',
  'sales.summary.tax': 'Tax (16%):',
  'sales.summary.total': 'Total:',
  'sales.summary.items': 'items',
  // Payment strings
  'sales.payment.title': 'Payment Processing',
  'sales.payment.method': 'Payment Method',
  'sales.payment.amount_paid': 'Amount Paid',
  'sales.payment.change': 'Change:',
  'sales.payment.total': 'Total to Pay:',
  'sales.session.start': 'Start Sales Session',
  'sales.session.end': 'End Session',
  'sales.session.active': 'Active Session',
});

// Reservations - MVP strings
Object.assign(DICTIONARY.es, {
  'reservations.title': 'Reservas',
  'reservations.subtitle': 'Gestiona reservas y horarios de servicios',
  'reservations.new_reservation': 'Nueva Reserva',
  'reservations.service': 'Servicio',
  'reservations.client': 'Cliente',
  'reservations.duration': 'Duración (horas)',
  'reservations.select_service': 'Seleccionar servicio...',
  'reservations.select_client': 'Seleccionar cliente...',
  'reservations.available_times': 'Horarios Disponibles',
  'reservations.create': 'Crear Reserva',
  'reservations.calendar': 'Calendario de Reservas',
  'reservations.cancel': 'Cancelar',
  'reservations.confirm_cancel': '¿Cancelar esta reserva?',
  'reservations.tab.calendar': 'Calendario',
  'reservations.tab.list': 'Lista de Reservas',
  'reservations.empty.title': 'Sin reservas',
  'reservations.empty.message': 'No hay reservas registradas',
  'reservations.error.title': 'Error',
  'reservations.search.placeholder': 'Buscar reservas...',
  'reservations.modal.edit': 'Editar Reserva',
  'reservations.modal.create': 'Crear Reserva',
  'reservations.status.confirmed': 'Confirmada',
  'reservations.status.cancelled': 'Cancelada',
  'reservations.status.pending': 'Pendiente',
  'reservations.status.reserved': 'Reservada',
  'reservations.welcome.title': 'Sistema de Reservas',
  'reservations.welcome.description': 'Este sistema te permite gestionar reservas y horarios de servicios. Para comenzar, necesitas cargar los datos desde la API.',
  'reservations.welcome.loading': 'Cargando...',
  'reservations.welcome.load_data': 'Cargar Datos del Sistema',
  'reservations.start_datetime': 'Fecha y Hora de Inicio',
  'reservations.no_services_available': 'No hay servicios disponibles',
  'reservations.no_clients_available': 'No hay clientes disponibles',
  'reservations.no_schedules_available': 'Sin horarios disponibles',
  'reservations.no_schedules_help': 'Prueba seleccionando otra fecha, producto o contacta al administrador para generar horarios.',
  'reservations.error.api_unavailable': 'No se pudo conectar con el servidor. Verifique su conexión a internet y que el servidor esté funcionando.',
  'reservations.error.endpoint_not_implemented': 'Los servicios de productos aún no están configurados en el servidor. Contacte al administrador del sistema para completar la configuración de la API.',
  'reservations.error.endpoint_not_found': 'Algunas funcionalidades aún no están disponibles. El sistema está en proceso de configuración.',
});

Object.assign(DICTIONARY.en, {
  'reservations.title': 'Reservations',
  'reservations.subtitle': 'Manage service reservations and schedules',
  'reservations.new_reservation': 'New Reservation',
  'reservations.service': 'Service',
  'reservations.client': 'Client',
  'reservations.duration': 'Duration (hours)',
  'reservations.select_service': 'Select service...',
  'reservations.select_client': 'Select client...',
  'reservations.available_times': 'Available Times',
  'reservations.create': 'Create Reservation',
  'reservations.calendar': 'Reservations Calendar',
  'reservations.cancel': 'Cancel',
  'reservations.confirm_cancel': 'Cancel this reservation?',
  'reservations.tab.calendar': 'Calendar',
  'reservations.tab.list': 'Reservations List',
  'reservations.empty.title': 'No reservations',
  'reservations.empty.message': 'No reservations registered',
  'reservations.error.title': 'Error',
  'reservations.search.placeholder': 'Search reservations...',
  'reservations.modal.edit': 'Edit Reservation',
  'reservations.modal.create': 'Create Reservation',
  'reservations.status.confirmed': 'Confirmed',
  'reservations.status.cancelled': 'Cancelled',
  'reservations.status.pending': 'Pending',
  'reservations.status.reserved': 'Reserved',
  'reservations.welcome.title': 'Reservations System',
  'reservations.welcome.description': 'This system allows you to manage service reservations and schedules. To get started, you need to load data from the API.',
  'reservations.welcome.loading': 'Loading...',
  'reservations.welcome.load_data': 'Load System Data',
  'reservations.start_datetime': 'Start Date and Time',
  'reservations.no_services_available': 'No services available',
  'reservations.no_clients_available': 'No clients available',
  'reservations.no_schedules_available': 'No schedules available',
  'reservations.no_schedules_help': 'Try selecting another date, product or contact the administrator to generate schedules.',
  'reservations.error.api_unavailable': 'Could not connect to the server. Check your internet connection and that the server is running.',
  'reservations.error.endpoint_not_implemented': 'Product services are not yet configured on the server. Contact the system administrator to complete API configuration.',
  'reservations.error.endpoint_not_found': 'Some features are not yet available. The system is in the process of configuration.',
});

// Schedules - MVP strings
Object.assign(DICTIONARY.es, {
  'schedules.title': 'Gestión de Horarios',
  'schedules.subtitle': 'Administra la disponibilidad de horarios para servicios',
  'schedules.search.placeholder': 'Buscar horarios...',
  'schedules.filter.all_products': 'Todos los servicios',
  'schedules.filter.date': 'Filtrar por fecha',
  'schedules.generate': 'Generar Horarios',
  'schedules.empty.title': 'Sin horarios',
  'schedules.empty.message': 'No hay horarios registrados para los filtros actuales',
  'schedules.error.title': 'Error',
  'schedules.status.available': 'Disponible',
  'schedules.status.unavailable': 'No Disponible',
  'schedules.disable': 'Deshabilitar',
  'schedules.enable': 'Habilitar',
  'schedules.modal.generate': 'Generar Horarios',
  'schedules.generate_type': 'Tipo de Generación',
  'schedules.generate.daily': 'Horarios diarios automáticos',
  'schedules.generate.date': 'Para fecha específica',
  'schedules.generate.next_days': 'Próximos N días',
  'schedules.target_date': 'Fecha Objetivo',
  'schedules.days_count': 'Número de Días',
  'schedules.tab.management': 'Gestión de Horarios',
  'schedules.generate.title': 'Generar Horarios',
  'schedules.available.title': 'Horarios del Día',
  'schedules.no_schedules': 'Sin horarios para esta fecha',
  'schedules.generate_help': 'Utiliza el panel de la izquierda para generar horarios o contacta al administrador del sistema',
  'schedules.select_service_date': 'Selecciona servicio y fecha',
  'schedules.select_help': 'Elige un servicio y una fecha para ver y gestionar los horarios disponibles',
});

Object.assign(DICTIONARY.en, {
  'schedules.title': 'Schedule Management',
  'schedules.subtitle': 'Manage schedule availability for services',
  'schedules.search.placeholder': 'Search schedules...',
  'schedules.filter.all_products': 'All services',
  'schedules.filter.date': 'Filter by date',
  'schedules.generate': 'Generate Schedules',
  'schedules.empty.title': 'No schedules',
  'schedules.empty.message': 'No schedules registered for current filters',
  'schedules.error.title': 'Error',
  'schedules.status.available': 'Available',
  'schedules.status.unavailable': 'Unavailable',
  'schedules.disable': 'Disable',
  'schedules.enable': 'Enable',
  'schedules.modal.generate': 'Generate Schedules',
  'schedules.generate_type': 'Generation Type',
  'schedules.generate.daily': 'Automatic daily schedules',
  'schedules.generate.date': 'For specific date',
  'schedules.generate.next_days': 'Next N days',
  'schedules.target_date': 'Target Date',
  'schedules.days_count': 'Number of Days',
  'schedules.tab.management': 'Schedule Management',
  'schedules.generate.title': 'Generate Schedules',
  'schedules.available.title': 'Day Schedules',
  'schedules.no_schedules': 'No schedules for this date',
  'schedules.generate_help': 'Use the left panel to generate schedules or contact the system administrator',
  'schedules.select_service_date': 'Select service and date',
  'schedules.select_help': 'Choose a service and a date to view and manage available schedules',
});

// Navigation strings
Object.assign(DICTIONARY.es, {
  'navigation.operations': 'Operaciones',
});

Object.assign(DICTIONARY.en, {
  'navigation.operations': 'Operations',
});

// Action strings
Object.assign(DICTIONARY.es, {
  'action.generating': 'Generando...',
  'action.generate': 'Generar',
  'action.saving': 'Guardando...',
  'action.create': 'Crear',
  'action.update': 'Actualizar',
  'action.cancel': 'Cancelar',
  'action.edit': 'Editar',
  'action.delete': 'Eliminar',
  'action.refresh': 'Actualizar',
  'action.refreshing': 'Actualizando...',
});

Object.assign(DICTIONARY.en, {
  'action.generating': 'Generating...',
  'action.generate': 'Generate',
  'action.saving': 'Saving...',
  'action.create': 'Create',
  'action.update': 'Update',
  'action.cancel': 'Cancel',
  'action.edit': 'Edit',
  'action.delete': 'Delete',
  'action.refresh': 'Refresh',
  'action.refreshing': 'Refreshing...',
});

// Suppliers - MVP strings
Object.assign(DICTIONARY.es, {
  'suppliers.title': 'Proveedores',
  'suppliers.action.create': 'Crear Proveedor',
  'suppliers.empty.title': 'Sin proveedores',
  'suppliers.empty.message': 'No hay proveedores registrados',
  'suppliers.error.title': 'Error al cargar proveedores',
  'suppliers.modal.create': 'CREAR PROVEEDOR',
  'suppliers.modal.edit': 'EDITAR PROVEEDOR',
  'suppliers.search.placeholder': 'Buscar proveedor...',
});
Object.assign(DICTIONARY.en, {
  'suppliers.title': 'Suppliers',
  'suppliers.action.create': 'Create Supplier',
  'suppliers.empty.title': 'No suppliers',
  'suppliers.empty.message': 'No suppliers registered',
  'suppliers.error.title': 'Error loading suppliers',
  'suppliers.modal.create': 'CREATE SUPPLIER',
  'suppliers.modal.edit': 'EDIT SUPPLIER',
  'suppliers.search.placeholder': 'Search supplier...',
});

let currentLang = 'es';
export const setI18nLang = (l) => { if (DICTIONARY[l]) currentLang = l; };
export const tRaw = (key) => (DICTIONARY[currentLang] && DICTIONARY[currentLang][key]) || key;

export function useI18n() {
  try {
    const [lang, setLangState] = useState(currentLang);
    const setLang = useCallback((l) => { if (DICTIONARY[l]) { currentLang = l; setLangState(l); } }, []);
    // soporta interpolación simple: t('key', { a: 1 }) -> reemplaza {a}
    const t = useCallback((key, vars) => {
      const template = (DICTIONARY[lang] && DICTIONARY[lang][key]) || key;
      if (!vars) return template;
      return String(template).replace(/\{(\w+)\}/g, (_, k) => (Object.prototype.hasOwnProperty.call(vars, k) ? String(vars[k]) : `{${k}}`));
    }, [lang]);
    return { t, lang, setLang };
  } catch (error) {
    // Fallback for React 19 hooks compatibility
    const lang = currentLang;
    const setLang = (l) => { if (DICTIONARY[l]) { currentLang = l; } };
    const t = (key, vars) => {
      const template = (DICTIONARY[currentLang] && DICTIONARY[currentLang][key]) || key;
      if (!vars) return template;
      return String(template).replace(/\{(\w+)\}/g, (_, k) => (Object.prototype.hasOwnProperty.call(vars, k) ? String(vars[k]) : `{${k}}`));
    };
    return { t, lang, setLang };
  }
}
